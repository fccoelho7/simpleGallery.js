!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.SimpleGallery=t()}}(function(){var t,e,n;return function t(e,n,i){function r(a,l){if(!n[a]){if(!e[a]){var s="function"==typeof require&&require;if(!l&&s)return s(a,!0);if(o)return o(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var f=n[a]={exports:{}};e[a][0].call(f.exports,function(t){var n=e[a][1][t];return r(n?n:t)},f,f.exports,t,e,n,i)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<i.length;a++)r(i[a]);return r}({1:[function(e,n,i){!function(e,n){if("function"==typeof t&&t.amd)t([],n);else if("undefined"!=typeof i)n();else{var r={exports:{}};n(),e.polyfills=r.exports}}(this,function(){"use strict";Element.prototype.is=function(t){switch(t[0]){case".":var e=new RegExp(t.replace(".",""));return this.className.match(e);case"#":return this.getAttribute("id")===t.replace("#","");default:return this.tagName===t.toUpperCase()}},Element.prototype.delegate=function(t,e,n){var i=this;i.addEventListener(t,function(t){var i=t.target;i.is(e)&&n.call(i,t),i.parentNode.is(e)&&n.call(i.parentNode,t)})},Array.prototype.swap=function(t,e){return this[t]=this.splice(e,1,this[t])[0],this}})},{}],2:[function(e,n,i){!function(r,o){if("function"==typeof t&&t.amd)t(["module","./polyfills"],o);else if("undefined"!=typeof i)o(n,e("./polyfills"));else{var a={exports:{}};o(a,r.polyfills),r.simpleGallery=a.exports}}(this,function(t){"use strict";function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var n=function(){function t(n){var i=arguments.length<=1||void 0===arguments[1]?"gallery":arguments[1],r=arguments.length<=2||void 0===arguments[2]?".gallery-container":arguments[2];e(this,t),this.form=document.querySelector(n),this.input=this.form.querySelector('input[name="'+i+'"]'),this.initDOM(r),this.initGallery(),this.initSortable(),this.eventListeners()}return t.prototype.initDOM=function t(e){this.form.querySelector(e).innerHTML+='\n\t\t\t<div class="gallery">\n\t\t\t\t<div class="gallery-items"></div>\n\t\t\t\t<div class="loading">\n\t\t\t\t\t<span class="bar"></span>\n\t\t\t\t</div>\n\t\t\t</div>'},t.prototype.initGallery=function t(){var e=this;if(this.input.value){var n=JSON.parse(this.input.value);if(0!=n.lenght){var i=n.reduce(function(t,n){return t+=e.generateDOM(n)},"");this.form.querySelector(".gallery-items").innerHTML=i}}},t.prototype.initSortable=function t(){var e=this,n=this.form.querySelector(".gallery-items");Sortable.create(n,{animation:150,onUpdate:function t(n){var i=JSON.parse(e.input.value),r=n.oldIndex,o=n.newIndex;i.swap(r,o),e.input.value=JSON.stringify(i)}})},t.prototype.eventListeners=function t(){this.form.querySelector(".upload").addEventListener("change",this.addItem.bind(this)),this.form.querySelector(".gallery").delegate("click",".remove",this.removeItem.bind(this)),this.form.querySelector(".gallery").delegate("change",".title",this.changeTitle.bind(this))},t.prototype.addItem=function t(e){e.preventDefault();var n=e.target.files,i=new FormData;for(var r in n){if(!n.hasOwnProperty(r))return;i.append("gallery[]",n[r])}this.request(i)},t.prototype.request=function t(e){var n=this,i=new XMLHttpRequest,r=this.form.getAttribute("data-action-gallery"),o=r?r:this.form.action,a=this.form.querySelector(".gallery");a.classList.add("loading-active"),i.onreadystatechange=function(){4==i.readyState&&(a.classList.remove("loading-active"),200==i.status&&n.addImages(i.responseText))},i.upload.addEventListener("progress",function(t){var e=n.form.querySelector(".loading .bar");e.style.width=Math.ceil(t.loaded/t.total*100)+"%"},!1),i.open("POST",o,!0),i.send(e)},t.prototype.addImages=function t(e){var n=JSON.parse(e),i=""!==this.input.value?JSON.parse(this.input.value):[];n.map(function(t){t.title="No description.",i.push(t)}),this.saveGallery(i)},t.prototype.removeItem=function t(e){e.preventDefault();var n=JSON.parse(this.input.value),i=e.target.parentElement,r=i.children[0].src;n.forEach(function(t,e){t.url===r&&n.splice(e,1)}),this.saveGallery(n)},t.prototype.saveGallery=function t(e){var n=this,i=e.reduce(function(t,e){return t+=n.generateDOM(e)},"");this.input.value=JSON.stringify(e),this.form.querySelector(".gallery-items").innerHTML=i},t.prototype.changeTitle=function t(e){var n=JSON.parse(this.input.value),i=e.target.parentElement,r=i.children[0].src;n.forEach(function(t,i){t.url===r&&(n[i].title=e.target.value)}),this.input.value=JSON.stringify(n)},t.prototype.generateDOM=function t(e){return'\n\t\t\t<div class="gallery-item">\n\t\t\t\t<img src=\''+e.url+"' alt='"+e.title+'\' />\n\t\t\t\t<input class="title" name="title" value="'+e.title+"\" />\n\t\t\t\t<button class='remove'>Ã—</button>\n\t\t\t</div>\n\t\t"},t}();t.exports=n})},{"./polyfills":1}]},{},[2])(2)});